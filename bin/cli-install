#!/usr/bin/env bash

set -e # exit on error

# Install pnpm
echo "[CLI] Installing nodejs and pnpm..."
sudo apt-get install -y -qq nodejs npm > /dev/null
sudo npm install -g pnpm rimraf > /dev/null
rimraf ./**/node_modules > /dev/null || true

echo "[CLI] Installing cli dependencies"
pnpm install -g turbo
pnpm install --filter @pedaki/cli --frozen-lockfile --production --ignore-script

echo "[CLI] Running tools"
pnpm build --filter @pedaki/cli > /dev/null
cd packages/cli && pnpm link --global > /dev/null && cd ../..

